README – Sistema de Biblioteca 

Descripción del Proyecto
El Sistema de Biblioteca Digital es una aplicación web desarrollada con Spring Boot para la gestión de usuarios, libros y préstamos. Utiliza autenticación segura mediante JWT y control de acceso basado en roles (ADMIN y USUARIO).
El sistema trabaja con DTOs, validaciones, manejo de excepciones personalizado y arquitectura en capas (controladores, servicios, repositorios).

Permite:

Registrar e iniciar sesión de usuarios.

Administrar libros, usuarios y préstamos.

Acceso seguro mediante token JWT.

Funciones especiales para usuarios como “mi cuenta” y “mis préstamos”.

Tecnologías Utilizadas

Java 21+

Spring Boot 3.x

Spring Security + JWT

Spring Data JPA / Hibernate

OracleSQL

Lombok

Swagger

Postman

Estructura del Proyecto
src/main/java/org.idat.Biblioteca/
controller/ → Controladores REST
dto/ → Clases DTO
entity/ → Entidades JPA
repository/ → Repositorios
service/ → Interfaces y clases de servicio
exception/ → Excepciones personalizadas
security/ → JWT, filtros y configuración

Requisitos Previos

Java 21

Maven

OracleSQL

Postman

Configuración de Base de Datos
(application.properties)

pring.datasource.url=jdbc:oracle:thin:@localhost:1521/XEPDB1
spring.datasource.username=biblioteca
spring.datasource.password=biblioteca123
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver

spring.jpa.database-platform=org.hibernate.dialect.OracleDialect
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

Seguridad y Roles
El sistema usa JWT para proteger los endpoints.

Roles disponibles:
ADMIN – control total
USUARIO – acceso limitado a sus propios datos y préstamos

Autenticación

Registro
POST /auth/register


Endpoints Principales

Usuarios
GET /usuarios/micuenta
PUT /usuarios/{id}
DELETE /usuarios/{id}
GET /usuarios

Libros
POST /libros
GET /libros
PUT /libros/{id}
DELETE /libros/{id}
Préstamos
POST /prestamos
GET /prestamos
GET /prestamos/misprestamos
PUT /prestamos/devolver
DELETE /prestamos/{id}

Instalación y Ejecución

Clonar repositorio

Compilar
mvn clean install

Ejecutar
BibliotecaApplication.java

Configuracion de Oracle SQL developer

Nombre= Biblioteca
Usuario= biblioteca
Contraseña= biblioteca123

Marcar Opcion Nombre de Servicio y usar (XEPDB1)

Insert de Tablas y Datos Iniciales

-- 1. TABLA ROLES
CREATE TABLE roles (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(20) NOT NULL UNIQUE
);

-- 2. TABLA USUARIOS
CREATE TABLE usuarios (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    email VARCHAR2(100) NOT NULL UNIQUE,
    password VARCHAR2(100) NOT NULL,
    nombre VARCHAR2(100) NOT NULL,
    rol_id NUMBER NOT NULL,
    FOREIGN KEY (rol_id) REFERENCES roles(id)
);

-- 3. TABLA LIBROS
CREATE TABLE libros (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    titulo VARCHAR2(200) NOT NULL,
    autor VARCHAR2(200) NOT NULL,
    cantidad_disponible NUMBER(5) DEFAULT 1
);

-- 4. TABLA PRÉSTAMOS
CREATE TABLE prestamos (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    usuario_id NUMBER NOT NULL,
    libro_id NUMBER NOT NULL,
    fecha_prestamo DATE DEFAULT SYSDATE,
    fecha_devolucion DATE,
    estado VARCHAR2(20) DEFAULT 'ACTIVO',
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id),
    FOREIGN KEY (libro_id) REFERENCES libros(id)
);

-- INSERTAR ROLES BÁSICOS
INSERT INTO roles (nombre) VALUES ('ADMIN');
INSERT INTO roles (nombre) VALUES ('USUARIO');

COMMIT;


Link de Documentacion de EndPoints Swagger

http://localhost:8080/api/swagger-ui/swagger-ui/index.html#/


